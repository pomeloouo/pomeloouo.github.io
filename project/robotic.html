<!DOCTYPE html> 
<html lang="zh-Hant"> 
<head> 
  <meta charset="UTF-8" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
  <title>Robotic 機械手臂專案</title> 
  <!-- Swiper --> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/> 
  <style> 
    :root { --maxW: 1100px; } 
    * { box-sizing: border-box; } 
    body { 
      margin: 0; 
      font-family: system-ui, -apple-system, "Segoe UI", Noto Sans, "微軟正黑體", Arial; 
      background: #0b0f14; 
      color: #dfe6ee; 
      line-height: 1.6; 
    } 
    a { color: #68b5ff; text-decoration: none; } 
    .topbar { 
      position: sticky; 
      top: 0; 
      z-index: 50; 
      backdrop-filter: blur(6px); 
      background: rgba(11,15,20,.6); 
      border-bottom: 1px solid rgba(255,255,255,.06); 
      padding: .75rem 1rem; 
    } 
    .topbar .wrap { 
      max-width: var(--maxW); 
      margin: 0 auto; 
      display: flex; 
      gap: .75rem; 
      align-items: center; 
    } 
    .topbar a.btn { 
      padding: .45rem .8rem; 
      border: 1px solid rgba(255,255,255,.15); 
      border-radius: 10px; 
    } 
    .hero { 
      min-height: 100vh; 
      background: radial-gradient(1000px 600px at 50% 20%, #122033 0%, #0b0f14 60%); 
      display: grid; 
      grid-template-rows: auto 1fr; 
      align-items: start; 
      padding: 2rem 1rem 3rem; 
    } 
    .hero-inner { 
      max-width: var(--maxW); 
      margin: 0 auto; 
      text-align: center; 
    } 
    .hero h1 { 
      margin: 0 0 .5rem; 
      font-size: clamp(32px, 6vw, 56px); 
      letter-spacing: .02em; 
    } 
    .hero p { 
      margin: 0 auto 1.25rem; 
      color: #a9b7c6; 
      max-width: 860px; 
    } 
    .hero-graphic { 
      max-width: var(--maxW); 
      margin: 1rem auto 0; 
      border-radius: 20px; 
      border: 1px solid rgba(255,255,255,.06); 
      box-shadow: 0 15px 60px rgba(0,0,0,.45), inset 0 0 80px rgba(88,157,255,.10); 
      overflow: hidden; 
      background: #132033; 
    } 
    .swiper { 
      width: 100%; 
      height: 80vh; 
      min-height: 420px; 
      position: relative; 
    } 
    .swiper-wrapper, .swiper-slide { 
      height: 100%; 
    } 
    .swiper-slide { 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      background: #0f1621; 
    } 
    .swiper-slide img, .swiper-slide video { 
      width: 100%; 
      height: 100%; 
      object-fit: cover; 
      display: block; 
    } 
    /* Google Drive iframe 也填滿 */ 
    .swiper-slide iframe { 
      width: 100%; 
      height: 100%; 
      border: 0; 
      display: block; 
    } 
    .swiper-pagination { 
      bottom: 10px !important; 
    } 
  </style> 
</head> 
<body> 
  <div class="topbar"> 
    <div class="wrap"> 
      <a class="btn" href="../index.html">← 回首頁</a> 
      <a class="btn" href="./lidar.html">LiDAR 專案</a> 
      <span style="opacity:.8">Robotic 機械手臂專案</span> 
    </div> 
  </div> 
  <section class="hero"> 
    <div class="hero-inner"> 
      <h1>Robotic 機械手臂專案</h1> 
      <p> 
        展示機械手臂在視覺導引、路徑規劃與即時控制中的應用。下方輪播可混合圖片與影片： 
        影片若放在 Google 雲端硬碟，直接貼分享連結即可嵌入播放。 
      </p> 
    </div> 
    <div class="hero-graphic"> 
      <div class="swiper"> 
        <div class="swiper-wrapper" id="roboticSlides"></div> 
        <div class="swiper-pagination"></div> 
        <div class="swiper-button-prev"></div> 
        <div class="swiper-button-next"></div> 
      </div> 
    </div> 
  </section> 

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script> 
  <script> 
    // ====== 1) 把你的媒體連結貼在這 ====== 
    // 可混用：圖片(.png/.jpg/.jpeg)、影片(.mp4)、Google Drive 連結 
    // 範例：把 'YOUR_DRIVE_LINK_HERE' 換成你實際的分享連結 
    const mediaList = [ 
      "./ppt/robotic1.jpg", 
      "./ppt/robotic2.jpg", 
      "./ppt/robotic3.jpg", 
      "./ppt/robotic4.jpg", 
      "https://drive.google.com/file/d/10-D3Nd22d_iCyb30oG7jbBQwZVg6rooI/view?usp=sharing", // 已是 preview 格式也可 
      "https://drive.google.com/file/d/17pL5GATn3R_LC9LBbnpPHyvhm1K0akFK/view?usp=sharing", 
      "https://drive.google.com/file/d/17pL5GATn3R_LC9LBbnpPHyvhm1K0akFK/view?usp=sharing", // 一般分享連結也行 
    ]; 

    // ====== 2) 小工具：抓 Drive 的 fileId，轉成可嵌入 preview 連結 ====== 
    function toDrivePreviewUrl(url) { 
      // 已經是 preview 
      if (/\/preview(\?|$)/.test(url)) return url; 
      // 可能是 /file/d/FILEID/... 
      let m = url.match(/drive\.google\.com\/file\/d\/([^/]+)/); 
      if (m && m[1]) return https://drive.google.com/file/d/${m[1]}/preview; 
      // 可能是 open?id=FILEID 或 uc?id=FILEID 
      m = url.match(/[?&](?:id)=([^&]+)/); 
      if (m && m[1]) return https://drive.google.com/file/d/${m[1]}/preview; 
      // 不是 Drive 連結就回傳原始 
      return url; 
    } 

    // 判斷是不是 Google Drive 連結 
    function isDriveLink(url) { 
      return /https?:\/\/(?:www\.)?drive\.google\.com\//.test(url); 
    } 

    // ====== 3) 產生 slide（自動判斷圖片 / mp4 / Drive） ====== 
    const wrapper = document.getElementById('roboticSlides'); 
    mediaList.forEach(src => { 
      const slide = document.createElement('div'); 
      slide.className = 'swiper-slide'; 
      if (isDriveLink(src)) { 
        const previewUrl = toDrivePreviewUrl(src); 
        const iframe = document.createElement('iframe'); 
        iframe.src = previewUrl; 
        iframe.allow = "autoplay; encrypted-media"; 
        iframe.loading = "lazy"; 
        iframe.referrerPolicy = "no-referrer"; 
        slide.appendChild(iframe); 
      } else if (/\.(mp4)$/i.test(src)) { 
        const video = document.createElement('video'); 
        video.src = src; 
        video.controls = true; 
        video.muted = true; 
        video.loop = true; 
        video.playsInline = true; 
        video.preload = "metadata"; 
        slide.appendChild(video); 
      } else { 
        const img = document.createElement('img'); 
        img.src = src; 
        slide.appendChild(img); 
      } 
      wrapper.appendChild(slide); 
    }); 

    // ====== 4) 初始化 Swiper ====== 
    const swiper = new Swiper('.swiper', { 
      loop: true, 
      pagination: { el: '.swiper-pagination', clickable: true }, 
      navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' }, 
      autoplay: { disableOnInteraction: false },
    }); 

    // ====== 5) 影片行為（僅針對 <video>，Drive iframe無法直接控） ====== 
    function wireVideoBehaviors() { 
      const videos = document.querySelectorAll('.swiper-slide video'); 
      videos.forEach(v => { 
        v.addEventListener('play', () => { 
          try { swiper.autoplay.stop(); } catch(e) {} 
        }); 
        v.addEventListener('pause', () => { 
          try { swiper.autoplay.start(); } catch(e) {} 
        }); 
        v.addEventListener('ended', () => { 
          try { swiper.slideNext(); swiper.autoplay.start(); } catch(e) {} 
        }); 
      }); 
    } 
    wireVideoBehaviors(); 

    // 切換投影片時，若前一張是 <video> 就停止重設 
    swiper.on('slideChange', () => { 
      document.querySelectorAll('.swiper-slide video').forEach(v => { 
        if (!v.paused) v.pause(); 
        v.currentTime = 0; 
      }); 
    }); 
  </script> 
</body> 
</html>

